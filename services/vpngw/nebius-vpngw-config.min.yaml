# Minimal config for VM creation and basic testing
version: 1

# Context via environment placeholders (export before running)
tenant_id: "tenant-e00f3wdfzwfjgbcyfv"
project_id: "project-e01y6xs5pr00gsdsyay8wq"
region_id: "eu-west1" # e.g., us-central1 | eu-north1 | eu-north2 | eu-west1

# Single gateway VM with essential spec only
gateway_group:
  name: "nebius-vpn-gw"
  instance_count: 1
  vm_spec:
    platform: "cpu-d3"
    preset: "32vcpu-128gb"
    disk_boot_image: ubuntu24.04-driverless
    disk_gb: 200
    disk_type: network_ssd
    disk_block_bytes: 4096
    # Explicit key paths (only paths, never key contents)
    ssh_public_key_path: "~/.ssh/id_ed25519.pub"
    ssh_private_key_path: "~/.ssh/id_ed25519"
    # Network/subnet configuration for the VM NIC
    # If omitted, uses the network named "default-network" and ensures a
    # /27 subnet named "vpngw-subnet" in that network.
    network_id: "${NETWORK_ID}"

# Minimal gateway section
gateway:
  local_asn: 65010
  local_prefixes:
  - 10.0.0.0/16
  quotas:
    max_connections: 1
    max_tunnels: 2
    max_total_bandwidth_mbps: null

# Defaults kept simple
defaults:
  vpn_type: ipsec
  ike_version: 2
  allow_ikev1: true
  auth:
    method: psk
  crypto:
    ike_proposals: [ "aes256-sha256-modp2048" ]
    ike_lifetime_seconds: 28800
    esp_proposals: [ "aes256-sha256" ]
    esp_lifetime_seconds: 3600
    dh_groups: [ 14 ]
  dpd:
    interval_seconds: 30
    timeout_seconds: 120
  routing:
    mode: bgp
    bgp:
      hold_time_seconds: 90
      keepalive_seconds: 30
      graceful_restart: true
      max_prefixes: 1000

# No connections yet; focus on VM creation
connections: []
